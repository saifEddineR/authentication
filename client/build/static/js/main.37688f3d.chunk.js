(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{37:function(e,t,r){},67:function(e,t,r){"use strict";r.r(t);var n,a,o=r(0),s=r.n(o),c=r(18),u=r.n(c),i=(r(37),r(3)),l=r(2),p=r(9),j=r(13),b=r(4),d=r(11),h=r.n(d),f=r(15),O=r(10),g=r(16),m=r.n(g),x=Object(O.b)("user/postNewUser",function(){var e=Object(f.a)(h.a.mark((function e(t,r){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.rejectWithValue,e.prev=1,e.next=4,m.a.post("http://localhost:5000/users/register",t);case 4:return a=e.sent,e.abrupt("return",a.data);case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",n(e.t0.response.data.message?e.t0.response.data.message:e.t0.response.data.errors.password.msg));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,r){return e.apply(this,arguments)}}()),v=Object(O.b)("user/login",function(){var e=Object(f.a)(h.a.mark((function e(t,r){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.rejectWithValue,e.prev=1,e.next=4,m.a.post("http://localhost:5000/users/login",t);case 4:return a=e.sent,e.abrupt("return",a.data);case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",n(e.t0.response.data.message));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,r){return e.apply(this,arguments)}}()),y=Object(O.c)({name:"user",initialState:{userInfo:JSON.parse(localStorage.getItem("user")),loading:!1,errors:null,token:localStorage.getItem("token"),isAuth:Boolean(localStorage.getItem("isAuth"))},reducers:{logout:function(e){console.log("logout"),e.isAuth=!1,e.userInfo={},e.token=null,localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("isAuth")}},extraReducers:(n={},Object(l.a)(n,x.pending,(function(e){e.loading=!0})),Object(l.a)(n,x.fulfilled,(function(e,t){console.log(t.payload),e.userInfo=t.payload.user,e.token=t.payload.token,e.isAuth=!0,e.errors=null,localStorage.setItem("token",t.payload.token),localStorage.setItem("user",JSON.stringify(t.payload.user)),localStorage.setItem("isAuth",!0)})),Object(l.a)(n,x.rejected,(function(e,t){e.errors=t.payload,e.isAuth=!1})),Object(l.a)(n,v.pending,(function(e){e.loading=!0})),Object(l.a)(n,v.fulfilled,(function(e,t){console.log(t.payload),e.userInfo=t.payload.user,e.token=t.payload.token,e.isAuth=!0,e.errors=null,localStorage.setItem("token",t.payload.token),localStorage.setItem("user",JSON.stringify(t.payload.user)),localStorage.setItem("isAuth",!0)})),Object(l.a)(n,v.rejected,(function(e,t){e.errors=t.payload,e.isAuth=!1})),n)}),k=y.reducer,S=y.actions.logout,w=r(1),I=function(e){var t=e.history,r=Object(b.b)(),n=Object(o.useState)({}),a=Object(j.a)(n,2),s=a[0],c=a[1],u=Object(b.c)((function(e){return e.user}));console.log(u),Object(o.useEffect)((function(){u.isAuth?t.push("/profile"):t.push("/login")}),[u.isAuth]);var i=function(e){c(Object(p.a)(Object(p.a)({},s),{},Object(l.a)({},e.target.name,e.target.value)))};return Object(w.jsxs)("form",{children:[Object(w.jsx)("input",{type:"email",placeholder:"email",name:"email",onChange:i}),Object(w.jsx)("input",{type:"password",placeholder:"password",name:"password",onChange:i}),Object(w.jsx)("button",{type:"submit",onClick:function(e){e.preventDefault(),r(v(s))},children:"Login"}),u&&u.errors&&Object(w.jsxs)("p",{children:[u.errors," "]})]})},A=function(e){var t=e.history,r=Object(b.b)(),n=Object(o.useState)({}),a=Object(j.a)(n,2),s=a[0],c=a[1],u=Object(b.c)((function(e){return e.user}));Object(o.useEffect)((function(){u.isAuth?t.push("/profile"):t.push("/register")}),[u.isAuth]);var i=function(e){c(Object(p.a)(Object(p.a)({},s),{},Object(l.a)({},e.target.name,e.target.value)))};return Object(w.jsxs)("form",{children:[Object(w.jsx)("input",{type:"text",placeholder:"full name",name:"fullName",onChange:i}),Object(w.jsx)("input",{type:"email",placeholder:"email",name:"email",onChange:i}),Object(w.jsx)("input",{type:"password",placeholder:"password",name:"password",onChange:i}),Object(w.jsx)("button",{type:"submit",onClick:function(e){e.preventDefault(),r(x(s))},children:"Login"}),u&&u.errors&&Object(w.jsxs)("p",{children:[u.errors," "]})]})},C=r(12),E=function(){var e=Object(b.b)(),t=Object(b.c)((function(e){return e.user}));return Object(w.jsxs)("div",{children:[Object(w.jsx)(C.b,{to:"/",children:"Home"}),t.isAuth?Object(w.jsx)(C.b,{to:"/login",onClick:function(){return e(S())},children:"logout"}):Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(C.b,{to:"/login",children:"Login"}),Object(w.jsx)(C.b,{to:"/register",children:"Register"})]})]})},N=Object(O.b)("posts/addnewpost",function(){var e=Object(f.a)(h.a.mark((function e(t,r){var n,a,o,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.rejectWithValue,a=r.dispatch,console.log(t),(o=new FormData).append("picture",t.file),o.append("info",JSON.stringify(t.postInfo)),e.prev=5,e.next=8,m.a.post("http://localhost:5000/posts/addpost",o,{headers:{token:localStorage.getItem("token")}});case 8:return s=e.sent,a(J()),e.abrupt("return",s.data);case 13:return e.prev=13,e.t0=e.catch(5),e.abrupt("return",n(e.t0.response.data.message?e.t0.response.data.message:e.t0.response.data.errors.password.msg));case 16:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(t,r){return e.apply(this,arguments)}}()),J=Object(O.b)("posts/getPosts",function(){var e=Object(f.a)(h.a.mark((function e(t,r){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.rejectWithValue,e.prev=1,e.next=4,m.a.get("http://localhost:5000/posts");case 4:return a=e.sent,e.abrupt("return",a.data);case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",n(e.t0.response.data.message));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,r){return e.apply(this,arguments)}}()),D=Object(O.c)({name:"posts",initialState:{posts:[],loading:!1,postErrors:null,postsErrors:null,post:{}},extraReducers:(a={},Object(l.a)(a,N.pending,(function(e){e.loading=!0})),Object(l.a)(a,N.fulfilled,(function(e,t){e.loading=!1,e.post=t.payload,e.postErrors=null})),Object(l.a)(a,N.rejected,(function(e,t){e.loading=!1,e.errors=t.payload})),Object(l.a)(a,J.pending,(function(e){e.loading=!0})),Object(l.a)(a,J.fulfilled,(function(e,t){e.loading=!1,e.posts=t.payload,e.postsErrors=null})),Object(l.a)(a,J.rejected,(function(e,t){e.loading=!1,e.errors=t.payload})),a)}).reducer,L=function(e){var t=e.history,r=Object(b.b)(),n=Object(b.c)((function(e){return e.user})),a=Object(b.c)((function(e){return e.post}));Object(o.useEffect)((function(){n.isAuth?r(J()):t.push("/login")}),[n.isAuth]);var s=Object(o.useState)({}),c=Object(j.a)(s,2),u=c[0],i=c[1],d=Object(o.useState)({}),h=Object(j.a)(d,2),f=h[0],O=h[1],g=function(e){i(Object(p.a)(Object(p.a)({},u),{},Object(l.a)({},e.target.name,e.target.value)))};return Object(w.jsxs)("div",{children:[Object(w.jsxs)("form",{children:[Object(w.jsx)("input",{type:"text",name:"title",onChange:g,placeholder:"title"}),Object(w.jsx)("input",{type:"text",name:"description",onChange:g,placeholder:"description"}),Object(w.jsx)("input",{type:"file",name:"file",onChange:function(e){return O(e.target.files[0])}}),Object(w.jsx)("button",{type:"submit",onClick:function(e){e.preventDefault(),r(N({postInfo:u,file:f}))},children:"add post"})]}),Object(w.jsx)("br",{}),Object(w.jsx)("div",{children:a.posts&&a.posts.map((function(e){return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("h2",{children:[e.title," "]}),Object(w.jsx)("img",{src:e.image.imageURL,alt:"workshop"}),Object(w.jsx)("p",{children:e.description})]})}))})]})};var R=function(){return Object(w.jsxs)("div",{className:"App",children:[Object(w.jsx)(E,{}),Object(w.jsxs)(i.c,{children:[Object(w.jsx)(i.a,{path:"/login",component:I}),Object(w.jsx)(i.a,{path:"/register",component:A}),Object(w.jsx)(i.a,{path:"/profile",component:L})]})]})},V=Object(O.a)({reducer:{user:k,post:D}});u.a.render(Object(w.jsx)(s.a.StrictMode,{children:Object(w.jsx)(b.a,{store:V,children:Object(w.jsx)(C.a,{children:Object(w.jsx)(R,{})})})}),document.getElementById("root"))}},[[67,1,2]]]);
//# sourceMappingURL=main.37688f3d.chunk.js.map